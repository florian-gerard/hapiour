<html>

<head>
	
	<script id="template" type="text/template">
		{{#adherents}}
		<th>{{name}}</th>
		<th>{{firstname}}</th>
		<th>{{email}}</th>
		<th>{{birthdate}}</th>
		<th>{{type}}</th>
		<th>{{link}}</th>
		<td>
			<button onclick= "openApplication('MesDocteurs', 'https://passconnect-preprod.groupe-vyv.fr', 'harmonie-mutuelle-rec')">Téléconsultation</button>
		</td>
		{{/adherents}}
    	</script>

<script src=https://passconnect-preprod.groupe-vyv.fr/auth-beneficiaires/js/beneficiaires-utils.js type="text/javascript"></script>
<script src="mustache.min.js" type="text/javascript"></script>

<script type="text/javascript">

(function(){

	function getAdherents(params) {
		var adherents_reg_exp = /(\?|&)datas=([^\?&]*)/;
		if(adherents_reg_exp.test(params)) {
			var result = adherents_reg_exp.exec(params);
			return JSON.parse(atob(result[2]));
		}
	}
	
	function renderAdherents(adherents) {
		var adherents = {adherents: adherents};
		var template = document.getElementById('template').innerHTML;
		var rendered = Mustache.render(template, adherents);
		
		document.getElementById('adherents').innerHTML = rendered;
	}

	window.onload = function() {
	
		var params = window.location.search;
		
		var adherents = getAdherents(params);
		
		if(adherents) {
			renderAdherents(adherents);
		}

	};

})();

</script>

</head>

<body>

<table>
	<thead>
		<tr>
			<th>Nom</th>
			<th>Prénom</th>
			<th>Email</th>
			<th>Date Naissance</th>
			<th>Type Utilisateur</th>
			<th>Lien</th>
			<th>Actions</th>

		</tr>
	</thead>
	<tbody id="adherents">
		
	</tbody>
	
</table>

</body>

</html>

